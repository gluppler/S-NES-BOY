# 1.1 NES System Overview

## System Applicability

**This document applies to:**
- ✅ **NES (Nintendo Entertainment System)**: Primary focus
- ✅ **Famicom**: Fully compatible (Japanese variant of NES, same hardware)
- ❌ **SNES**: Does not apply (different architecture - see SNES-specific documentation)

**Note**: Famicom and NES are hardware-identical except for cartridge connector and controller ports. All NES programming concepts apply directly to Famicom.

## Physical Hardware Overview

The Nintendo Entertainment System (NES) and Famicom are composite systems consisting of:

* **Ricoh 2A03 CPU** (6502 variant, ~1.79 MHz NTSC, ~1.66 MHz PAL)
* **Ricoh 2C02 PPU** (Picture Processing Unit, ~5.37 MHz NTSC, ~5.32 MHz PAL)
* **APU** (Audio Processing Unit, integrated into 2A03)
* **Cartridge slot** (connects PRG ROM, CHR ROM, and optional mapper hardware)
* **2 KB RAM** (CPU-accessible work RAM at $0000–$1FFF, mirrored)
* **2 KB VRAM** (PPU-accessible video RAM, typically at $2000–$3EFF)

The CPU and PPU operate on separate buses. The CPU cannot directly access PPU memory; all communication occurs through memory-mapped I/O registers ($2000–$2007).

## NES/Famicom Terminology Definitions

* **NTSC**: North American/Japanese video standard (60.098 Hz frame rate, 262 scanlines)
* **PAL**: European video standard (50.007 Hz frame rate, 312 scanlines)
* **VBlank**: Vertical blanking period (scanlines 241–260 NTSC, 241–310 PAL) when PPU is not rendering
* **Scanline**: One horizontal line of video output (~63.5 CPU cycles NTSC, ~83 CPU cycles PAL)
* **Frame**: One complete screen refresh (262 scanlines NTSC, 312 scanlines PAL)
* **NMI**: Non-Maskable Interrupt, triggered at start of VBlank
* **Mapper**: Cartridge hardware that remaps PRG/CHR ROM banks to CPU/PPU address space

## Core Rules and Invariants

* Everything revolves around **VBlank**. Safe PPU VRAM access occurs only during VBlank or forced blanking.
* The CPU runs at ~1.79 MHz (NTSC). One frame = ~29,780 CPU cycles.
* The PPU renders 240 visible scanlines, then enters VBlank for ~20 scanlines (NTSC).
* NMI fires once per frame at the start of VBlank (scanline 241).
* CPU memory map is fixed: $0000–$1FFF RAM (mirrored), $2000–$3FFF PPU registers (mirrored), $4000–$401F APU/I/O, $4020–$5FFF cartridge expansion, $6000–$7FFF cartridge RAM, $8000–$FFFF cartridge PRG ROM.
* PPU memory map: $0000–$1FFF pattern tables (CHR ROM/RAM), $2000–$2EFF name tables (background), $3F00–$3F1F palettes, $3F20–$3FFF mirrors.

## Minimal Correct Usage Example

```asm
; Minimal NES initialization
reset:
    SEI          ; Disable interrupts
    CLD          ; Clear decimal mode
    LDX #$FF
    TXS          ; Initialize stack pointer
    INX          ; X = 0
    STX $2000    ; Disable PPU rendering
    STX $2001    ; Disable rendering
    STX $4010    ; Disable DMC IRQ
    
    ; Wait for PPU to stabilize
    BIT $2002    ; Clear VBlank flag
vblank_wait1:
    BIT $2002
    BPL vblank_wait1
    
    ; Clear RAM
    LDA #0
clear_ram:
    STA $0000,X
    STA $0100,X
    STA $0200,X
    STA $0300,X
    STA $0400,X
    STA $0500,X
    STA $0600,X
    STA $0700,X
    INX
    BNE clear_ram
    
    ; Wait for second VBlank
vblank_wait2:
    BIT $2002
    BPL vblank_wait2
    
    ; Initialize PPU
    LDA #%10000000  ; Enable NMI
    STA $2000
    LDA #%00011110  ; Enable rendering
    STA $2001
    
    ; Main loop
main_loop:
    JMP main_loop

nmi:
    RTI
```

## Explicit Non-Goals

This section does not cover:
* Detailed CPU instruction set (see 1.2)
* Memory map specifics (see 1.3)
* PPU rendering details (see 1.4)
* Cartridge mapper details beyond Mapper 0 (see 1.5)
* Timing-critical operations (see 2.1, 2.2)
* Game loop architecture (see 3.1)

## Cross-References

- Related Fundamentals: 1.2 (CPU), 1.3 (Memory), 1.4 (PPU), 1.5 (ROM)
- Related Advanced Fundamentals: 2.1 (CPU Timing), 2.2 (NMI & VBlank)
- Related Core Concepts: 3.1 (Game Loop)
- Related Cheatsheets: 4.3 (Memory), 4.4 (Timing)
