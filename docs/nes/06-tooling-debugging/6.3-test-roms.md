# 6.3 Test ROMs

## System Applicability

**This document applies to:**
- âœ… **NES**: Primary focus

## Overview

Test ROMs are essential tools for verifying NES hardware behavior, emulator accuracy, and code correctness. This document catalogs authoritative test ROMs for NES development.

## Test ROM Categories

### CPU Tests

**blargg_nes_cpu_test5:**
- Comprehensive 6502 instruction tests
- Tests all addressing modes
- Verifies cycle accuracy
- **Purpose**: Validate CPU emulation accuracy

**cpu_timing_test6:**
- Cycle-accurate timing tests
- Branch timing verification
- Page crossing penalties
- **Purpose**: Verify CPU timing behavior

**cpu_interrupts_v2:**
- NMI timing tests
- IRQ handling tests
- Interrupt vector tests
- **Purpose**: Validate interrupt system

**cpu_reset:**
- Reset vector tests
- Power-up state verification
- Reset button behavior
- **Purpose**: Verify reset behavior

**cpu_dummy_reads:**
- Dummy read behavior tests
- Read timing verification
- **Purpose**: Validate dummy read cycles

**cpu_dummy_writes:**
- Dummy write behavior tests
- Write timing verification
- **Purpose**: Validate dummy write cycles

**cpu_exec_space:**
- Execution space tests
- ROM/RAM execution tests
- **Purpose**: Verify code execution locations

**instr_test-v5:**
- Instruction test suite
- Comprehensive opcode testing
- **Purpose**: Validate all 6502 instructions

**instr_timing:**
- Instruction timing tests
- Cycle count verification
- **Purpose**: Verify instruction cycle counts

**branch_timing_tests:**
- Branch instruction timing
- Page crossing penalties
- **Purpose**: Validate branch timing

### PPU Tests

**blargg_ppu_tests_2005.09.15b:**
- PPU rendering tests
- Sprite evaluation tests
- **Purpose**: Validate PPU behavior

**ppu_vbl_nmi:**
- VBlank timing tests
- NMI timing verification
- **Purpose**: Verify frame timing

**ppu_read_buffer:**
- PPU read buffer tests
- $2007 read behavior
- **Purpose**: Validate PPU read quirks

**ppu_open_bus:**
- Open bus behavior tests
- Unmapped memory reads
- **Purpose**: Verify bus behavior

**sprite_hit_tests_2005.10.05:**
- Sprite 0 hit tests
- Sprite priority tests
- **Purpose**: Validate sprite hit detection

**sprite_overflow_tests:**
- Sprite overflow behavior
- 8 sprite per scanline limit
- **Purpose**: Verify sprite overflow flag

**oam_read:**
- OAM read tests
- OAM corruption tests
- **Purpose**: Validate OAM access

**oam_stress:**
- OAM stress tests
- Sprite evaluation stress
- **Purpose**: Test sprite system limits

### APU Tests

**apu_test:**
- APU channel tests
- Frame counter tests
- **Purpose**: Validate APU behavior

**apu_reset:**
- APU reset behavior
- Power-up state tests
- **Purpose**: Verify APU initialization

**apu_mixer:**
- APU mixing tests
- Channel mixing verification
- **Purpose**: Validate audio mixing

**blargg_apu_2005.07.30:**
- Comprehensive APU tests
- Channel behavior verification
- **Purpose**: Validate APU accuracy

**pal_apu_tests:**
- PAL APU timing tests
- PAL-specific behavior
- **Purpose**: Verify PAL APU differences

**volume_tests:**
- Volume control tests
- Envelope tests
- **Purpose**: Validate volume behavior

### Mapper Tests

**mmc3_test:**
- MMC3 mapper tests
- IRQ timing tests
- **Purpose**: Validate MMC3 behavior

**mmc3_irq_tests:**
- MMC3 IRQ tests
- A12 clocking tests
- **Purpose**: Verify MMC3 IRQ

**mmc3_test_2:**
- Additional MMC3 tests
- Scanline timing
- **Purpose**: Validate MMC3 scanline behavior

**mmc5test_v2:**
- MMC5 mapper tests
- Advanced mapper features
- **Purpose**: Validate MMC5 behavior

**MMC1_A12:**
- MMC1 A12 tests
- CHR banking tests
- **Purpose**: Verify MMC1 behavior

### Timing Tests

**nmi_sync:**
- NMI synchronization tests
- Frame timing verification
- **Purpose**: Validate NMI timing

**vbl_nmi_timing:**
- VBlank/NMI timing tests
- Frame boundary tests
- **Purpose**: Verify frame timing

**scanline:**
- Scanline timing tests
- Raster effect tests
- **Purpose**: Validate scanline timing

**scanline-a1:**
- Alternative scanline tests
- Timing edge cases
- **Purpose**: Verify scanline behavior

### Specialized Tests

**dmc_dma_during_read4:**
- DMC DMA timing tests
- DMA conflict tests
- **Purpose**: Validate DMC DMA behavior

**dpcmletterbox:**
- DMC sample tests
- DMA timing verification
- **Purpose**: Verify DMC behavior

**full_palette:**
- Palette tests
- Color accuracy tests
- **Purpose**: Validate palette system

**instr_misc:**
- Miscellaneous instruction tests
- Edge case verification
- **Purpose**: Test instruction quirks

**nes_instr_test:**
- NES-specific instruction tests
- Unofficial opcode tests
- **Purpose**: Validate instruction behavior

## Using Test ROMs

### Running Test ROMs

1. **Build test ROM**: Follow test ROM's build instructions
2. **Load in emulator**: Open ROM in Mesen2, FCEUX, or Nestopia
3. **Observe results**: Test ROMs display pass/fail status
4. **Verify on hardware**: Test on real NES hardware for final validation

### Interpreting Results

**Pass**: Test ROM displays "PASS" or shows expected behavior
**Fail**: Test ROM displays "FAIL" or shows unexpected behavior
**Hang**: Test ROM freezes (indicates critical failure)

### Test ROM Development

Test ROMs are authoritative sources for:
- Hardware behavior verification
- Emulator accuracy testing
- Code correctness validation
- Timing edge case discovery

## Test ROM Collection

Test ROMs are available in the S-NES-BOY framework under `tests/nes/`:
- **Location**: `tests/nes/` - Comprehensive collection of NES test ROMs
- **Purpose**: Hardware-accurate test suites for verification and validation
- **Usage**: Reference implementations for NES behavior
- **Details**: See [`tests/nes/README.md`](../../../../tests/nes/README.md) for complete test catalog
- **Sources**: See REFERENCES.md for original test ROM repositories

## Integration with Development

### During Development

1. **Run relevant test ROMs** before implementing features
2. **Verify behavior** matches test ROM expectations
3. **Test edge cases** identified by test ROMs
4. **Validate timing** using timing test ROMs

### Before Release

1. **Run full test suite** on real hardware
2. **Verify emulator compatibility** with test ROMs
3. **Check timing accuracy** with timing tests
4. **Validate mapper behavior** (if using mappers)

## Cross-References

- Related Tooling: 6.1 (Toolchain), 6.2 (Emulators & Debuggers)
- Related Advanced Fundamentals: 2.1 (CPU Timing), 2.3 (PPU Rendering Rules)
- Related References: REFERENCES.md (Emulator Tests section)
