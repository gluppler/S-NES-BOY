# 4.5 Audio Cheatsheets

## System Applicability

**This cheatsheet applies to:
- ✅ **: Fully compatible (same APU, plus expansion audio support)

**-Specific Notes:
-  supports expansion audio chips (VRC6, VRC7, FDS audio)
- Expansion audio registers are mapper-specific
- See 2.5 Audio Fundamentals for expansion audio details


## APU Register Map ($4000–$401F)

| Address | Channel | Register | Bits | Description |
|---------|---------|----------|------|-------------|
| $4000 | Pulse 1 | Control | D D V V V V V V | Duty, volume, envelope |
| $4001 | Pulse 1 | Sweep | E P P P S S S S | Enable, period, shift |
| $4002 | Pulse 1 | Timer Low | T T T T T T T T | Period low byte |
| $4003 | Pulse 1 | Timer High | L L L L L T T T | Length counter, period high |
| $4004 | Pulse 2 | Control | D D V V V V V V | Duty, volume, envelope |
| $4005 | Pulse 2 | Sweep | E P P P S S S S | Enable, period, shift |
| $4006 | Pulse 2 | Timer Low | T T T T T T T T | Period low byte |
| $4007 | Pulse 2 | Timer High | L L L L L T T T | Length counter, period high |
| $4008 | Triangle | Control | C R R R R R R R | Linear counter control |
| $4009 | Triangle | Unused | — | Unused |
| $400A | Triangle | Timer Low | T T T T T T T T | Period low byte |
| $400B | Triangle | Timer High | L L L L L T T T | Length counter, period high |
| $400C | Noise | Control | L V V V V V V V | Loop, volume, envelope |
| $400D | Noise | Unused | — | Unused |
| $400E | Noise | Period | L P P P P P P P | Loop, period, mode |
| $400F | Noise | Length | L L L L L L L L | Length counter |
| $4010 | DMC | Control | I L P P P P P P | IRQ, loop, period |
| $4011 | DMC | Value | D D D D D D D D | Direct load |
| $4012 | DMC | Address | A A A A A A A A | Sample address (high) |
| $4013 | DMC | Length | L L L L L L L L | Sample length (high) |
| $4014 | OAM | DMA | A A A A A A A A | OAM DMA high byte |
| $4015 | Status | Enable | I D N T P P P P | Channel enable, status |
| $4016 | Controller 1 | I/O | D D D D D D D D | Strobe (W), data (R) |
| $4017 | Controller 2 / Frame | I/O | M I D D D D D D | Data (R), frame counter (W) |

## Pulse Channel Control ($4000, $4004)

| Bits | Name | Values | Meaning |
|------|------|--------|---------|
| 7–6 | Duty | 00, 01, 10, 11 | 12.5%, 25%, 50%, 75% duty cycle |
| 5 | Constant | 0, 1 | 0 = envelope, 1 = constant volume |
| 4–0 | Volume | 0–15 | Volume (envelope or constant) |

## Pulse Channel Sweep ($4001, $4005)

| Bits | Name | Values | Meaning |
|------|------|--------|---------|
| 7 | Enable | 0, 1 | Sweep enable |
| 6–4 | Period | 0–7 | Sweep period (0 = disabled) |
| 3 | Negate | 0, 1 | 0 = add, 1 = subtract |
| 2–0 | Shift | 0–7 | Sweep shift amount |

## Triangle Channel Control ($4008)

| Bits | Name | Values | Meaning |
|------|------|--------|---------|
| 7 | Control | 0, 1 | Linear counter control |
| 6–0 | Reload | 0–127 | Linear counter reload value |

**Note: Triangle has no volume control (always full volume when enabled).

## Noise Channel Control ($400C)

| Bits | Name | Values | Meaning |
|------|------|--------|---------|
| 7 | Loop | 0, 1 | Loop noise |
| 5 | Constant | 0, 1 | 0 = envelope, 1 = constant volume |
| 4–0 | Volume | 0–15 | Volume (envelope or constant) |

## Noise Channel Period ($400E)

| Bits | Name | Values | Meaning |
|------|------|--------|---------|
| 7 | Loop | 0, 1 | Loop mode (15-bit or 7-bit LFSR) |
| 6–0 | Period | 0–15 | Noise period index |

## DMC Channel Control ($4010)

| Bits | Name | Values | Meaning |
|------|------|--------|---------|
| 7 | IRQ | 0, 1 | IRQ enable |
| 6 | Loop | 0, 1 | Loop sample |
| 3–0 | Period | 0–15 | Sample rate index |

**DMC Period Table:
| Index | Rate (Hz) | CPU Cycles/Byte |
|-------|-----------|-----------------|
| 0 | 4,180 | ~428 |
| 1 | 3,726 | ~480 |
| 2 | 3,141 | ~569 |
| 3 | 2,789 | ~641 |
| 4 | 2,349 | ~761 |
| 5 | 2,095 | ~853 |
| 6 | 1,767 | ~1,012 |
| 7 | 1,490 | ~1,200 |
| 8 | 1,245 | ~1,437 |
| 9 | 1,110 | ~1,612 |
| 10 | 936 | ~1,912 |
| 11 | 780 | ~2,295 |
| 12 | 655 | ~2,734 |
| 13 | 546 | ~3,280 |
| 14 | 468 | ~3,825 |
| 15 | 418 | ~4,280 |

## APU Status ($4015)

| Bit | Channel | R/W | Meaning |
|-----|---------|-----|---------|
| 7 | DMC | R | DMC active |
| 6 | Noise | R/W | Noise enable |
| 5 | Triangle | R/W | Triangle enable |
| 4 | Pulse 2 | R/W | Pulse 2 enable |
| 3 | Pulse 1 | R/W | Pulse 1 enable |
| 2–0 | — | — | Unused |

**Write: Enable/disable channels
**Read: Check if channels are active

## Frame Counter ($4017)

| Bit | Name | Values | Meaning |
|-----|------|--------|---------|
| 7 | Mode | 0, 1 | 0 = 4-step, 1 = 5-step |
| 6 | IRQ Inhibit | 0, 1 | 1 = disable frame counter IRQ |
| 5–0 | — | — | Unused |

**Frame Counter Modes:
- **4-step: 240 Hz timing, generates IRQ on frame 4 (if enabled)
- **5-step: 192 Hz timing, no IRQ

## Length Counter Values

| Index | Length (frames) |
|-------|----------------|
| 0 | — (infinite) |
| 1 | 10 |
| 2 | 254 |
| 3 | 20 |
| 4 | 2 |
| 5 | 40 |
| 6 | 4 |
| 7 | 80 |
| 8 | 14 |
| 9 | 16 |
| 10 | 28 |
| 11 | 32 |
| 12 | 56 |
| 13 | 64 |
| 14 | 96 |
| 15 | 128 |
| 16 | 160 |
| 17 | 192 |
| 18 | 224 |
| 19 | 240 |
| 20 | 24 |
| 21 | 26 |
| 22 | 30 |
| 23 | 34 |
| 24 | 36 |
| 25 | 38 |
| 26 | 42 |
| 27 | 44 |
| 28 | 48 |
| 29 | 50 |
| 30 | 52 |
| 31 | 54 |

**Note: Index is written to timer high register (bits 7–3).

## Critical Notes

- **Frame counter: Must be initialized (write $4017) to start timing
- **Length counter: Automatically decrements, stops channel when expired
- **Envelope: Automatically updates every frame (4-step or 5-step mode)
- **DMC DMA: Steals CPU cycles (4 cycles per sample byte)
- **Triangle: No volume control, always full volume when enabled
- **Pulse sweep: Can sweep frequency up or down (or disable)

## Cross-References

- Related Advanced Fundamentals: 2.5 (Audio Fundamentals), 2.1 (CPU Timing & Cycles)
- Related Core Concepts: None (audio is mostly independent)
- Related Cheatsheets: 4.4 (Timing Cheatsheets)
